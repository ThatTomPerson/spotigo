package ref_test

import (
	"testing"

	"github.com/stretchr/testify/assert"
	"ttp.sh/spotigo/internal/pkg/shannon/ref"
)

var TestKey []byte

func init() {
	TestKey = []byte{0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8}
}

func Test(t *testing.T) {
	c := ref.New(TestKey)
	e := []byte{1, 2, 3, 4}
	r := c.Encrypt(e)
	f := c.Finish(r)

	assert.Equal(t, e, r)
	assert.Equal(t, e, f)
}
